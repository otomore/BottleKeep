# 開発環境構築ガイド

## 概要
BottleKeep（ウイスキー管理iOS/iPadアプリ）の開発環境に関する情報をまとめた資料です。

## 現在の開発環境

### 開発マシン
- **OS**: Windows
- **所有デバイス**: iPhone、iPad
- **未所有**: Mac

## iOS開発における制約

### macOSが必要な理由
1. **Xcode**: iOS開発に必須のIDEはmacOSでのみ動作
2. **証明書管理**: Apple Developer証明書の生成・管理にmacOSが必要
3. **App Store提出**: Xcodeからの提出が必要

## 開発環境の選択肢

### 1. Mac購入オプション
| 機種 | 価格帯 | メリット | デメリット |
|------|--------|---------|------------|
| Mac mini (M2) | 約8万円〜 | コスパ最高、デスクトップ性能 | 初期投資が必要 |
| 中古Intel Mac | 5〜7万円 | 安価 | 性能が劣る、サポート期限 |

### 2. クラウドMacサービス

#### AWS EC2 Mac インスタンス
- **料金**:
  - Intel版（mac1）: 約$1.083/時間
  - M1版（mac2）: 約$0.6498/時間
- **制約**: 最低利用期間24時間
- **月額換算**: 約$470〜780（継続利用の場合）

#### 専門クラウドサービス
| サービス | 月額料金 | 特徴 |
|----------|----------|------|
| MacinCloud | $20〜99 | 時間単位プラン有、開発環境構築済み |
| MacStadium | $79〜 | 安定性高い、専用サーバー |
| Codemagic | 無料枠500分/月 | CI/CD特化 |
| Bitrise | 無料枠あり | 自動化ビルド |

### 3. その他のオプション
- **Google Cloud**: Macインスタンス提供なし
- **Azure DevOps**: macOSビルドエージェント（無料枠1,800分/月）
- **GitHub Actions**: セルフホステッドランナー利用可能

## 採用する開発方針

### フェーズ1: プロトタイプ開発
**AWS EC2 Macインスタンスを活用**

#### 利用方法
1. 週1回、24時間単位でインスタンスを起動
2. まとめて開発・ビルド・実機テスト実施
3. TestFlight経由で実機配布

#### コスト
- 週1回利用: 約$26/回
- 月4回利用: 約$104/月（約15,000円）
- Apple Developer Program: 年$99

#### ワークフロー
```
月〜木: Windowsで設計・コーディング準備
  ↓
金曜: AWS Macインスタンス起動（24時間）
  ↓
土曜午前まで: Xcode開発・ビルド・実機テスト
  ↓
実機での動作確認・フィードバック収集
```

### フェーズ2: 本格開発
**Mac mini購入**
- プロトタイプで手応えを感じたら購入
- 開発効率の大幅向上
- 継続的な開発が可能に

## 必要な準備

### 1. アカウント関連
- [ ] Apple ID作成
- [ ] Apple Developer Program登録（$99/年）
- [ ] AWSアカウント作成
- [ ] GitHubリポジトリ作成 ✅

### 2. AWS Mac インスタンスセットアップ手順
1. AWS EC2でDedicated Host予約
2. mac2.metalインスタンス起動（M1推奨）
3. VNC/Screen Sharing設定
4. Xcode インストール
5. 開発証明書設定

### 3. 開発ツール
- **Windows側**:
  - VSCode（Swift拡張機能）
  - Git
  - GitHub CLI ✅
  - デザインツール（Figma等）

- **AWS Mac側**:
  - Xcode
  - CocoaPods/Swift Package Manager
  - TestFlight

## リスク管理

### メリット
- 初期投資を抑えられる
- 開発の実現可能性を低リスクで検証
- 必要に応じてスケールアップ可能

### 注意点
- 24時間の最低利用時間制約
- ネットワーク遅延の可能性
- 定期的なコスト発生

### セキュリティ考慮事項
- **証明書管理**: Apple Developer証明書はKeychain経由で安全に保管
- **ソースコード**: 機密性の高いコードは暗号化した状態でクラウドに保存
- **アクセス制御**: AWS MACインスタンスへのVPNアクセス設定
- **開発者アカウント**: 2ファクタ認証を必須設定

### バックアップ戦略
- **ソースコード**: GitHubリポジトリによる自動バックアップ
- **開発環境**: AWS AMIスナップショットの定期作成
- **証明書**: ローカル環境とクラウドでの複数箇所保存
- **プロジェクト設定**: Xcodeプロジェクト設定のバージョン管理

## 移行計画

### Mac mini購入判断基準
- [ ] プロトタイプが期待通り動作
- [ ] ユーザーフィードバックが良好
- [ ] 継続開発の意思決定
- [ ] 月$100以上のクラウド費用が3ヶ月継続

### 購入後の移行
1. 開発環境の移行
2. 証明書・プロファイルの移管
3. ローカル開発環境の最適化
4. CI/CD環境の構築

## まとめ
Windows環境からiOSアプリ開発を始めるため、AWS EC2 Macインスタンスを活用した段階的なアプローチを採用。初期リスクを抑えつつ、実機での動作確認まで可能な環境を構築し、プロトタイプ開発を進める。成功の見込みが立った時点でMac miniを購入し、本格的な開発体制に移行する。

---
*最終更新: 2025年1月*